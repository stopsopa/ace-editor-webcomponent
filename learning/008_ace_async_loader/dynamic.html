<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>008 - Ace Editor Dynamic Demo</title>

    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1400px;
        margin: 20px auto;
        padding: 0 20px;
        line-height: 1.6;
        background: #f5f5f5;
      }
      h1 {
        color: #333;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
      }
      h2 {
        color: #667eea;
        margin-top: 30px;
      }
      .controls {
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .add-button {
        padding: 12px 24px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
        font-size: 16px;
      }
      .add-button:hover {
        background: #764ba2;
      }
      .editor-wrapper {
        background: white;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
      }
      .editor-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 2px solid #e0e0e0;
      }
      .editor-title {
        font-size: 18px;
        font-weight: bold;
        color: #667eea;
      }
      .remove-button {
        padding: 8px 16px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: bold;
      }
      .remove-button:hover {
        background: #c82333;
      }
      .editor-controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
        padding: 15px;
        background: #f9f9f9;
        border-radius: 5px;
      }
      .control-group {
        display: flex;
        flex-direction: column;
      }
      .control-group label {
        font-weight: bold;
        margin-bottom: 5px;
        color: #333;
        font-size: 14px;
      }
      .control-group select,
      .control-group input[type="checkbox"] {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
      }
      .select-with-buttons {
        display: flex;
        gap: 5px;
        align-items: stretch;
      }
      .select-with-buttons select {
        flex: 1;
      }
      .select-buttons {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .select-btn {
        padding: 4px 8px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
        font-size: 12px;
        line-height: 1;
        font-weight: bold;
      }
      .select-btn:hover {
        background: #764ba2;
      }
      .select-btn:active {
        background: #5568d3;
      }
      .control-group input[type="checkbox"] {
        width: 20px;
        height: 20px;
        cursor: pointer;
      }
      .checkbox-wrapper {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .editor-content {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 20px;
      }
      .column {
        display: flex;
        flex-direction: column;
      }
      .column h3 {
        margin: 0 0 10px 0;
        color: #333;
        font-size: 16px;
      }
      textarea {
        width: 100%;
        min-height: 300px;
        padding: 10px;
        font-family: "Courier New", monospace;
        font-size: 14px;
        border: 2px solid #ddd;
        border-radius: 4px;
        resize: vertical;
      }
      textarea:focus {
        outline: none;
        border-color: #667eea;
      }
      /* ace-editor {
        min-height: 300px;
      } */
      .info-box {
        background: #e3f2fd;
        border-left: 4px solid #2196f3;
        padding: 15px;
        margin: 20px 0;
        border-radius: 4px;
      }
      .info-box strong {
        color: #1976d2;
      }
      #editors-list {
        min-height: 100px;
      }
      .empty-state {
        text-align: center;
        padding: 40px;
        color: #999;
        font-style: italic;
      }
    </style>

    <!-- Load the ace-web-component script with configuration -->
    <script
      src="./ace-web-component.js"
      data-main-ace="/noprettier/ace/ace-builds-1.15.0/src-min-noconflict/ace.js"
    ></script>
  </head>
  <body>
    <h1>Lesson 008: Ace Editor - Dynamic Demo</h1>

    <p>
      <a href="./index.html">‚Üê Back to Main Lesson</a>
    </p>

    <div class="info-box">
      <strong>üéÆ Interactive Demo:</strong> This page demonstrates real-time
      attribute updates to the <code>&lt;ace-editor&gt;</code> web component.
      Change any control and see the editor update instantly!
    </div>

    <h2>ace-onload Event</h2>
    <p>
      Before we dive into dynamic controls, let me introduce a powerful global
      event that's available for advanced configuration scenarios. The
      <code>'ace-onload'</code> event is not always needed for basic usage, but
      it becomes invaluable when you need to configure each editor instance
      beyond the standard attributes available on the main
      <code>&lt;ace-editor&gt;</code> tag.
    </p>
    <p>
      <strong>üì° Lifecycle Hook:</strong> This event fires once per editor when
      it's fully initialized, providing access to both the web component wrapper
      and the native Ace Editor instance. Use it to apply advanced
      configurations, attach custom event handlers, or integrate with other
      libraries that need direct editor access.
    </p>

    <ace-editor id="editor-for-logs" lang="javascript" readonly>
      <script type="module">
        // Listen for ace-onload events from ALL ace-editor components
        document.addEventListener("ace-onload", (event) => {
          // TypeScript notation showing what's available in event.detail:
          // event.detail: {
          //   component: HTMLElement,  // The <ace-editor> web component element
          //   editor: AceEditor,       // The native Ace Editor instance (same as component.getEditor())
          //   id: string               // The ID of the editor (auto-generated or user-provided)
          // }

          const log = document.getElementById("event-log");
          const timestamp = new Date().toLocaleTimeString();
          log.textContent += `[${timestamp}] ace-onload fired for #${event.detail.id}\n`;
          log.scrollTop = log.scrollHeight;
        });

        // Function to clear the event log
        window.clearEventLog = () => {
          const log = document.getElementById("event-log");
          log.textContent = "";
        };
      </script>
    </ace-editor>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 10px;
        "
      >
        <h3 style="margin: 0" id="logs">Event Log</h3>
        <button
          onclick="clearEventLog()"
          style="
            padding: 8px 16px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
          "
        >
          Clear Log
        </button>
      </div>
      <pre
        id="event-log"
        style="
          background: #f8f9fa;
          padding: 15px;
          border-radius: 4px;
          max-height: 200px;
          overflow-y: auto;
          font-size: 13px;
          line-height: 1.5;
        "
      ></pre>
    </div>

    <hr style="margin: 40px 0; border: none; border-top: 2px solid #e0e0e0" />

    <h2>Getting Started: Loading the Web Component</h2>

    <p>
      <strong>üì¶ Setup:</strong> Before you can use the
      <code>&lt;ace-editor&gt;</code> tag, you need to load the web component
      script. This is a one-time setup in the <code>&lt;head&gt;</code> section
      of your HTML document.
    </p>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <h3 style="margin-top: 0">Step 1: Load the Script</h3>
      <p>
        Add this <code>&lt;script&gt;</code> tag to your HTML
        <code>&lt;head&gt;</code> section:
      </p>

      <ace-editor
        lang="html"
        readonly
      >
      
      &lt;script src="./ace-web-component.js" data-main-ace="/noprettier/ace/ace-builds-1.15.0/src-min-noconflict/ace.js">&lt;/script>
    
    </ace-editor>

      <div
        style="
          padding: 15px;
          background: #e3f2fd;
          border-left: 4px solid #2196f3;
          border-radius: 4px;
          margin-top: 15px;
        "
      >
        <strong>üí° Explanation:</strong>
        <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8">
          <li>
            <code>src="./ace-web-component.js"</code> - Loads the web component
            definition that registers the custom
            <code>&lt;ace-editor&gt;</code> element
          </li>
          <li>
            <code>data-main-ace="..."</code> - Tells the component where to find
            the Ace Editor library. This path should point to your
            <code>ace.js</code> file
          </li>
        </ul>
      </div>
    </div>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <h3 style="margin-top: 0">Step 2: Use the &lt;ace-editor&gt; Tag</h3>
      <p>
        Once the script is loaded, you can now use the
        <code>&lt;ace-editor&gt;</code> tag anywhere in your HTML document!
      </p>

      <h4 style="color: #667eea; margin-top: 20px">
        Basic Example - JavaScript Code
      </h4>
      <p>Here's how to create a simple JavaScript editor:</p>

      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 30px;
        "
      >
        <div>
          <h5 style="margin: 10px 0; color: #333">HTML Code:</h5>
          <ace-editor
            lang="html"
            readonly
            min-height-lines="6"
          >
          <script type="ace">
    <ace-editor lang="javascript">
        function greet(name) {
            console.log("Hello, " + name + "!");
        }

        greet("World");
    </ace-editor>
</script>
</ace-editor>
        </div>
        <div>
          <h5 style="margin: 10px 0; color: #333">Live Result:</h5>
          <ace-editor lang="javascript">
function greet(name) {
  console.log("Hello, " + name + "!");
}

greet("World");
          </ace-editor>
        </div>
      </div>

      <h4 style="color: #667eea; margin-top: 30px">
        Example with Attributes - Python Code
      </h4>
      <p>
        You can customize the editor with attributes like and others...
        <code>theme</code> and <code>readonly</code>:
      </p>

      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 30px;
        "
      >
        <div>
          <h5 style="margin: 10px 0; color: #333">HTML Code:</h5>
          <ace-editor
            lang="html"
            readonly
            min-height-lines="8"
          >
            <script type="ace">
                <ace-editor lang="python" theme="monokai" readonly>

                    def factorial(n):
                        if n <= 1:
                            return 1
                        return n * factorial(n - 1)

                    print(factorial(5))
                </ace-editor>
            </script>
        </ace-editor>
        </div>
        <div>
          <h5 style="margin: 10px 0; color: #333">Live Result:</h5>
          <ace-editor lang="python" theme="monokai" readonly>
def factorial(n):
    if n <= 1:
        return 1
    return n * factorial(n - 1)

print(factorial(5))
          </ace-editor>
        </div>
      </div>

      <div
        style="
          padding: 15px;
          background: #d4edda;
          border-left: 4px solid #28a745;
          border-radius: 4px;
          margin-top: 20px;
        "
      >
        <strong style="color: #155724">‚úÖ That's it!</strong> Once you load the
        script, the <code>&lt;ace-editor&gt;</code> tag becomes available
        throughout your entire page. You can use it as many times as you need,
        just like any other HTML element!
      </div>
    </div>

    <hr style="margin: 40px 0; border: none; border-top: 2px solid #e0e0e0" />

    <h2>Auto-Generated IDs & Duplicate Detection</h2>
    <p>
      <strong>üÜî Understanding Editor IDs:</strong> Each
      <code>&lt;ace-editor&gt;</code> component requires a unique ID to function
      properly. The component handles IDs in two ways:
    </p>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <h3 style="margin-top: 0">Example 1: Auto-Generated IDs (Recommended)</h3>
      <p>
        When you <strong>don't provide</strong> an <code>id</code> attribute,
        the component automatically generates a unique ID like
        <code>ace-editor-1</code>, <code>ace-editor-2</code>, etc. This is the
        <strong>easiest and safest approach</strong> for most cases.
      </p>

      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 20px;
        "
      >
        <div>
          <h4 style="margin: 10px 0; color: #667eea">
            Without ID (auto-generated)
          </h4>

          <pre
            style="
              margin-top: 10px;
              background: #f8f9fa;
              padding: 10px;
              border-radius: 4px;
              font-size: 12px;
            "
          >
&lt;ace-editor lang="javascript"&gt;
  console.log("Hello, World!");
&lt;/ace-editor&gt;</pre

          >

          <button id="render1">render</button>
          <script>

                const render1 = document.getElementById("render1");
                render1.addEventListener("click", () => {
                  const editor = document.createElement("ace-editor");
                  editor.setAttribute("lang", "javascript");
                  editor.textContent = `console.log("Hello, World!");`;
                  render1.parentNode.appendChild(editor)
                  
                  const p = document.createElement("p");
                  p.innerHTML = `Now see last log (at the bottom) in the <a href="#logs">Event Log</a> section above.`;
                  render1.parentNode.appendChild(p)
                });
          </script>
        </div>

      </div>

      <div
        style="
          padding: 15px;
          background: #d4edda;
          border-left: 4px solid #28a745;
          border-radius: 4px;
          margin-bottom: 30px;
        "
      >
        <strong style="color: #155724">‚úÖ Best Practice:</strong> Don't provide
        an ID unless you specifically need to reference the editor by ID. Let
        the component auto-generate IDs to avoid conflicts.
      </div>

      <h3>Example 2: Manual IDs (Use with Caution)</h3>
      <p>
        When you <strong>do provide</strong> an <code>id</code> attribute, you
        are responsible for ensuring uniqueness.
        <strong style="color: #dc3545"
          >If you accidentally use the same ID twice, the component will throw
          an error.</strong
        >
      </p>

      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 20px;
        "
      >
        <div>
          <h4 style="margin: 10px 0; color: #28a745">
            ‚úÖ With Unique ID (valid)
          </h4>
          <ace-editor id="my-editor-1" lang="javascript">
            console.log("Hello, World!");
          </ace-editor>
          <pre
            style="
              margin-top: 10px;
              background: #f8f9fa;
              padding: 10px;
              border-radius: 4px;
              font-size: 12px;
            "
          >
&lt;ace-editor id="my-editor-1" lang="javascript"&gt;
  console.log("Hello, World!");
&lt;/ace-editor&gt;</pre
          >
        </div>

        <div>
          <h4 style="margin: 10px 0; color: #28a745">
            ‚úÖ With Different ID (valid)
          </h4>
          <ace-editor id="my-editor-2" lang="python">
            print("Hello, World!")
          </ace-editor>
          <pre
            style="
              margin-top: 10px;
              background: #f8f9fa;
              padding: 10px;
              border-radius: 4px;
              font-size: 12px;
            "
          >
&lt;ace-editor id="my-editor-2" lang="python"&gt;
  print("Hello, World!")
&lt;/ace-editor&gt;</pre
          >
        </div>
      </div>

      <div
        style="
          padding: 15px;
          background: #fff3cd;
          border-left: 4px solid #ffc107;
          border-radius: 4px;
          margin-bottom: 30px;
        "
      >
        <strong style="color: #856404">‚ö†Ô∏è Warning:</strong> When providing
        manual IDs, you must ensure each ID is unique across
        <strong>all</strong> ace-editor components on the page. Duplicate IDs
        will cause errors!
      </div>

      <h3>Example 3: Duplicate ID Error</h3>
      <p style="color: #dc3545; font-weight: bold">
        ‚ùå The second editor below intentionally uses a DUPLICATE
        <code>id="duplicate-test"</code> to demonstrate the error handling:
      </p>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px">
        <div>
          <h4 style="margin: 10px 0; color: #28a745">
            ‚úÖ First Editor (valid)
          </h4>
          <pre
            style="
              margin-top: 10px;
              background: #f8f9fa;
              padding: 10px;
              border-radius: 4px;
              font-size: 12px;
            "
          >
&lt;ace-editor id="duplicate-test" lang="javascript"&gt;
  console.log("First editor");
&lt;/ace-editor&gt;</pre
          >
          <ace-editor id="duplicate-test" lang="javascript">            console.log("First editor");          </ace-editor>
        </div>
        <div>
          <h4 style="margin: 10px 0; color: #dc3545">
            ‚ùå Second Editor (duplicate ID)
          </h4>
          <pre
            style="
              margin-top: 10px;
              background: #f8f9fa;
              padding: 10px;
              border-radius: 4px;
              font-size: 12px;
            "
          >
&lt;ace-editor id="duplicate-test" lang="javascript"&gt;
  console.log("This should fail");
&lt;/ace-editor&gt;</pre
          >
          <ace-editor id="duplicate-test" lang="javascript">
            console.log("This should fail");
          </ace-editor>
        </div>
      </div>

      <div
        style="
          margin-top: 20px;
          padding: 15px;
          background: #e3f2fd;
          border-radius: 4px;
        "
      >
        <strong>üí° How it works:</strong>
        <ul style="margin: 10px 0; padding-left: 20px">
          <li>
            <strong>No ID provided</strong> ‚Üí Component generates unique ID like
            <code>ace-editor-1</code>, <code>ace-editor-2</code>, etc.
          </li>
          <li>
            <strong>Unique ID provided</strong> ‚Üí Component validates it's
            unique across all ace-editors and uses it
          </li>
          <li>
            <strong>Duplicate ID detected</strong> ‚Üí Component throws error and
            shows red error box instead of loading
          </li>
          <li>
            <strong>Component removed</strong> ‚Üí ID is unregistered and can be
            reused on a new editor
          </li>
        </ul>
      </div>
    </div>

    <hr style="margin: 40px 0; border: none; border-top: 2px solid #e0e0e0" />

    <h2>Dynamic Editor Controls</h2>

    <p>
      <strong>üéÆ Interactive Demo:</strong> This section demonstrates real-time
      manipulation of <code>&lt;ace-editor&gt;</code> attributes. Click "Add New
      Editor" to create a fully interactive editor instance with live controls.
    </p>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <h3 style="margin-top: 0">What This Demo Shows</h3>
      <p>
        Each editor you create will have <strong>three synchronized panels</strong>:
      </p>
      <ul style="line-height: 1.8">
        <li>
          <strong>‚úèÔ∏è Edit Code (Textarea)</strong> - A standard HTML textarea
          where you type your code. Changes here update the Ace Editor in
          real-time.
        </li>
        <li>
          <strong>üî• Live Preview (Ace Editor)</strong> - The actual
          <code>&lt;ace-editor&gt;</code> web component rendering your code with
          syntax highlighting, themes, and all configured attributes applied.
        </li>
        <li>
          <strong>üìù HTML Usage Example</strong> - Shows the exact HTML markup
          needed to reproduce what you see in the "Live Preview" section. This
          panel automatically updates to reflect your current configuration
          (language, theme, readonly status, min-height settings, etc.).
        </li>
      </ul>

      <div
        style="
          padding: 15px;
          background: #e3f2fd;
          border-radius: 4px;
          margin-top: 15px;
        "
      >
        <strong>üí° Key Feature:</strong> The "HTML Usage Example" panel is
        particularly useful - it generates the exact
        <code>&lt;ace-editor&gt;</code> tag with all attributes you've
        configured, so you can copy-paste it directly into your own projects!
      </div>
    </div>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <h3 style="margin-top: 0">Available Attributes</h3>
      <p>
        The <code>&lt;ace-editor&gt;</code> component supports the following
        attributes:
      </p>

      <table
        style="
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
          font-size: 14px;
        "
      >
        <thead>
          <tr style="background: #667eea; color: white">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd">
              Attribute
            </th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd">
              Type
            </th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 122px;">
              Default
            </th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd">
              Description
            </th>
          </tr>
        </thead>
        <tbody>
          <tr style="background: #f9f9f9">
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              id
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">String</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">ace-editor-N</code>
              <br>
              <small style="color: #666">(auto-generated)</small>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Unique identifier for the editor. Auto-generated if not provided
              (e.g., <code>ace-editor-1</code>, <code>ace-editor-2</code>). Must be unique across all
              ace-editors on the page.
            </td>
          </tr>
          <tr>
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              lang
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">String</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">javascript</code>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Programming language mode for syntax highlighting. Default is <code>javascript</code>.
              Other examples: <code>python</code>, <code>typescript</code>,
              <code>go</code>, <code>html</code>, <code>css</code>, <code>json</code>, <code>text</code> (plain text, no highlighting), etc.
            </td>
          </tr>
          <tr style="background: #f9f9f9">
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              theme
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">String</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">idle_fingers</code>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Visual theme for the editor. Default is <code>idle_fingers</code> (dark theme).
              Other popular options: <code>monokai</code>,
              <code>github</code>, <code>dracula</code>,
              <code>solarized_dark</code>, <code>solarized_light</code>, <code>ambiance</code>, etc.
            </td>
          </tr>
          <tr>
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              value
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">String</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">""</code>
              <br>
              <small style="color: #666">(empty)</small>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Initial content of the editor. Default is empty string. Can also be provided as text content
              between the opening and closing tags. Supports both attribute and
              inner content approaches.
            </td>
          </tr>
          <tr style="background: #f9f9f9">
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              readonly
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">Boolean</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">false</code>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Makes the editor read-only (no user editing allowed). Default is <code>false</code> (editable).
              Presence of attribute = true, absence = false. Example:
              <code>&lt;ace-editor readonly&gt;</code>
            </td>
          </tr>
          <tr>
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              min-height-lines
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">Number</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">none</code>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Minimum height of the editor measured in number of lines. No minimum by default (auto-sizes to content).
              Example: <code>min-height-lines="10"</code> ensures at least 10 lines are
              visible.
            </td>
          </tr>
          <tr style="background: #f9f9f9">
            <td
              style="
                padding: 10px;
                border: 1px solid #ddd;
                font-family: monospace;
              "
            >
              min-height-px
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">Number</td>
            <td style="padding: 10px; border: 1px solid #ddd">
              <code style="background: #e8f4f8; padding: 2px 6px; border-radius: 3px">none</code>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd">
              Minimum height of the editor measured in pixels. No minimum by default (auto-sizes to content).
              Example: <code>min-height-px="300"</code> ensures at least 300px height.
              Cannot be used with <code>min-height-lines</code> simultaneously.
            </td>
          </tr>
        </tbody>
      </table>

      <div
        style="
          padding: 15px;
          background: #fff3cd;
          border-left: 4px solid #ffc107;
          border-radius: 4px;
          margin-top: 20px;
        "
      >
        <strong style="color: #856404">‚ö†Ô∏è Note:</strong> The
        <code>min-height-lines</code> and <code>min-height-px</code> attributes
        are mutually exclusive. If both are provided, <code>min-height-px</code>
        takes precedence.
      </div>
    </div>

    <h2>Try It: Add New Editors</h2>
    <p>
      Click the button below to dynamically create new editor instances and
      experiment with different configurations!
    </p>

    <div class="controls">
      <button class="add-button" onclick="addEditor()">
        ‚ûï Add New Editor
      </button>
    </div>

    <div id="editors-list">
      <div class="empty-state">Click "Add New Editor" to get started!</div>
    </div>

    <script>
      // Code snippets for different languages
      const CODE_SNIPPETS = {
        javascript: `// JavaScript Example
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

console.log(fibonacci(10));`,

        python: `# Python Example
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n - 1) + fibonacci(n - 2)

print(fibonacci(10))`,

        typescript: `// TypeScript Example
function fibonacci(n: number): number {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

console.log(fibonacci(10));`,

        go: `// Go Example
package main

import "fmt"

func fibonacci(n int) int {
    if n <= 1 {
        return n
    }
    return fibonacci(n-1) + fibonacci(n-2)
}

func main() {
    fmt.Println(fibonacci(10))
}`,
      };

      // Available themes (all Ace Editor themes)
      const THEMES = [
        "ambiance",
        "chaos",
        "chrome",
        "clouds",
        "clouds_midnight",
        "cobalt",
        "crimson_editor",
        "dawn",
        "dracula",
        "dreamweaver",
        "eclipse",
        "github",
        "gob",
        "gruvbox",
        "idle_fingers",
        "iplastic",
        "katzenmilch",
        "kr_theme",
        "kuroir",
        "merbivore",
        "merbivore_soft",
        "mono_industrial",
        "monokai",
        "nord_dark",
        "pastel_on_dark",
        "solarized_dark",
        "solarized_light",
        "sqlserver",
        "terminal",
        "textmate",
        "tomorrow",
        "tomorrow_night",
        "tomorrow_night_blue",
        "tomorrow_night_bright",
        "tomorrow_night_eighties",
        "twilight",
        "vibrant_ink",
        "xcode",
      ];

      const LANGUAGES = ["javascript", "python", "typescript", "go"];

      let editorCounter = 0;

      function addEditor() {
        editorCounter++;
        const editorId = `editor-${editorCounter}`;
        const wrapperId = `wrapper-${editorCounter}`;

        // Remove empty state if it exists
        const emptyState = document.querySelector(".empty-state");
        if (emptyState) {
          emptyState.remove();
        }

        // Create wrapper
        const wrapper = document.createElement("div");
        wrapper.className = "editor-wrapper";
        wrapper.id = wrapperId;

        // Create header
        const header = document.createElement("div");
        header.className = "editor-header";

        const title = document.createElement("div");
        title.className = "editor-title";
        title.textContent = `Editor #${editorCounter}`;

        const removeBtn = document.createElement("button");
        removeBtn.className = "remove-button";
        removeBtn.textContent = "üóëÔ∏è Remove";
        removeBtn.onclick = () => removeEditor(wrapperId);

        header.appendChild(title);
        header.appendChild(removeBtn);

        // Create controls
        const controls = document.createElement("div");
        controls.className = "editor-controls";

        // Language selector
        const langGroup = document.createElement("div");
        langGroup.className = "control-group";
        langGroup.innerHTML = `
          <label for="${editorId}-lang">Language:</label>
          <div class="select-with-buttons">
            <select id="${editorId}-lang">
              ${LANGUAGES.map(
                (lang) =>
                  `<option value="${lang}">${
                    lang.charAt(0).toUpperCase() + lang.slice(1)
                  }</option>`
              ).join("")}
            </select>
            <div class="select-buttons">
              <button class="select-btn" data-select="${editorId}-lang" data-dir="up">‚ñ≤</button>
              <button class="select-btn" data-select="${editorId}-lang" data-dir="down">‚ñº</button>
            </div>
          </div>
        `;

        // Theme selector
        const themeGroup = document.createElement("div");
        themeGroup.className = "control-group";
        themeGroup.innerHTML = `
          <label for="${editorId}-theme">Theme:</label>
          <div class="select-with-buttons">
            <select id="${editorId}-theme">
              ${THEMES.map(
                (theme) =>
                  `<option value="${theme}">${theme
                    .replace(/_/g, " ")
                    .replace(/\b\w/g, (l) => l.toUpperCase())}</option>`
              ).join("")}
            </select>
            <div class="select-buttons">
              <button class="select-btn" data-select="${editorId}-theme" data-dir="up">‚ñ≤</button>
              <button class="select-btn" data-select="${editorId}-theme" data-dir="down">‚ñº</button>
            </div>
          </div>
        `;

        // Snippet selector
        const snippetGroup = document.createElement("div");
        snippetGroup.className = "control-group";
        snippetGroup.innerHTML = `
          <label for="${editorId}-snippet">Load Snippet:</label>
          <div class="select-with-buttons">
            <select id="${editorId}-snippet">
              <option value="">-- Select Snippet --</option>
              ${LANGUAGES.map(
                (lang) =>
                  `<option value="${lang}">${
                    lang.charAt(0).toUpperCase() + lang.slice(1)
                  } Example</option>`
              ).join("")}
            </select>
            <div class="select-buttons">
              <button class="select-btn" data-select="${editorId}-snippet" data-dir="up">‚ñ≤</button>
              <button class="select-btn" data-select="${editorId}-snippet" data-dir="down">‚ñº</button>
            </div>
          </div>
        `;

        // Readonly checkbox
        const readonlyGroup = document.createElement("div");
        readonlyGroup.className = "control-group";
        readonlyGroup.innerHTML = `
          <label for="${editorId}-readonly">Readonly:</label>
          <div class="checkbox-wrapper">
            <input type="checkbox" id="${editorId}-readonly">
            <span>Lock editor</span>
          </div>
        `;

        // Min-height control group
        const minHeightGroup = document.createElement("div");
        minHeightGroup.className = "control-group";
        minHeightGroup.innerHTML = `
          <label>Min Height:</label>
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <div class="checkbox-wrapper">
              <input type="checkbox" id="${editorId}-enable-min-height">
              <span>Enable min height</span>
            </div>
            <div id="${editorId}-min-height-controls" style="display: none; padding-left: 10px;">
              <div style="display: flex; gap: 10px; margin-bottom: 5px;">
                <label style="display: flex; align-items: center; gap: 5px;">
                  <input type="radio" name="${editorId}-height-unit" value="lines" checked>
                  <span>Lines</span>
                </label>
                <label style="display: flex; align-items: center; gap: 5px;">
                  <input type="radio" name="${editorId}-height-unit" value="px">
                  <span>Pixels</span>
                </label>
              </div>
              <input type="number" id="${editorId}-min-height-value" value="10" min="1" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
          </div>
        `;

        controls.appendChild(langGroup);
        controls.appendChild(themeGroup);
        controls.appendChild(snippetGroup);
        controls.appendChild(readonlyGroup);
        controls.appendChild(minHeightGroup);

        // Create content area
        const content = document.createElement("div");
        content.className = "editor-content";

        // Left column - Textarea
        const leftCol = document.createElement("div");
        leftCol.className = "column";
        leftCol.innerHTML = `
          <h3>‚úèÔ∏è Edit Code (Textarea)</h3>
          <textarea id="${editorId}-textarea">${CODE_SNIPPETS.javascript}</textarea>
        `;

        // Middle column - Live Ace Editor
        const middleCol = document.createElement("div");
        middleCol.className = "column";
        middleCol.innerHTML = `
          <h3>üî• Live Preview (Ace Editor)</h3>
          <ace-editor id="${editorId}" lang="javascript" value="${CODE_SNIPPETS.javascript}"></ace-editor>
        `;

        // Right column - HTML Usage Example
        const rightCol = document.createElement("div");
        rightCol.className = "column";
        rightCol.innerHTML = `
          <h3>üìù HTML Usage Example</h3>
          <ace-editor id="${editorId}-html-view" lang="html"></ace-editor>
        `;

        content.appendChild(leftCol);
        content.appendChild(middleCol);
        content.appendChild(rightCol);

        // Assemble wrapper
        wrapper.appendChild(header);
        wrapper.appendChild(controls);
        wrapper.appendChild(content);

        // Add to DOM
        document.getElementById("editors-list").appendChild(wrapper);

        // Get references
        const aceEditor = document.getElementById(editorId);
        const htmlViewEditor = document.getElementById(`${editorId}-html-view`);
        const textarea = document.getElementById(`${editorId}-textarea`);
        const langSelect = document.getElementById(`${editorId}-lang`);
        const themeSelect = document.getElementById(`${editorId}-theme`);
        const snippetSelect = document.getElementById(`${editorId}-snippet`);
        const readonlyCheckbox = document.getElementById(
          `${editorId}-readonly`
        );
        const enableMinHeightCheckbox = document.getElementById(
          `${editorId}-enable-min-height`
        );
        const minHeightControls = document.getElementById(
          `${editorId}-min-height-controls`
        );
        const minHeightValue = document.getElementById(
          `${editorId}-min-height-value`
        );
        const heightUnitRadios = document.getElementsByName(
          `${editorId}-height-unit`
        );

        // Function to generate HTML code representation
        function generateHtmlCode() {
          const currentLang = langSelect.value;
          const currentTheme = themeSelect.value;
          const currentValue = textarea.value;
          const isReadonly = readonlyCheckbox.checked;
          const minHeightEnabled = enableMinHeightCheckbox.checked;

          const escapedValue = currentValue
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;");

          let htmlCode = `<ace-editor\n  id="${editorId}"\n  lang="${currentLang}"`;

          if (currentTheme !== "ambiance") {
            htmlCode += `\n  theme="${currentTheme}"`;
          }

          if (isReadonly) {
            htmlCode += `\n  readonly`;
          }

          if (minHeightEnabled) {
            const selectedUnit = Array.from(heightUnitRadios).find(
              (r) => r.checked
            ).value;
            const heightVal = minHeightValue.value;
            if (selectedUnit === "lines") {
              htmlCode += `\n  min-height-lines="${heightVal}"`;
            } else {
              htmlCode += `\n  min-height-px="${heightVal}"`;
            }
          }

          htmlCode += `\n>\n${escapedValue}\n</ace-editor>`;

          return htmlCode;
        }

        // Update HTML view
        function updateHtmlView() {
          if (htmlViewEditor && htmlViewEditor.setValue) {
            htmlViewEditor.setValue(generateHtmlCode());
          } else {
            // Editor not ready yet, try again after a delay
            setTimeout(updateHtmlView, 200);
          }
        }

        // Initial HTML view update (wait longer for ace-editor to initialize)
        setTimeout(updateHtmlView, 1500);

        // Setup event listeners

        // Textarea updates ace-editor value attribute
        textarea.addEventListener("input", () => {
          aceEditor.setAttribute("value", textarea.value);
          updateHtmlView();
        });

        // Language change
        langSelect.addEventListener("change", () => {
          aceEditor.setAttribute("lang", langSelect.value);
          updateHtmlView();
        });

        // Theme change
        themeSelect.addEventListener("change", () => {
          aceEditor.setAttribute("theme", themeSelect.value);
          updateHtmlView();
        });

        // Snippet loader - function to load snippet
        const loadSnippet = () => {
          if (snippetSelect.value) {
            const snippet = CODE_SNIPPETS[snippetSelect.value];
            textarea.value = snippet;
            aceEditor.setAttribute("value", snippet);
            updateHtmlView();
          }
        };

        // Load on change (clicking an option)
        snippetSelect.addEventListener("change", loadSnippet);

        // Load on keydown (arrow keys)
        snippetSelect.addEventListener("keydown", (e) => {
          if (e.key === "ArrowUp" || e.key === "ArrowDown") {
            // Wait for the select value to update, then load
            setTimeout(loadSnippet, 0);
          }
        });

        // Readonly toggle
        readonlyCheckbox.addEventListener("change", () => {
          if (readonlyCheckbox.checked) {
            aceEditor.setAttribute("readonly", "");
          } else {
            aceEditor.removeAttribute("readonly");
          }
          updateHtmlView();
        });

        // Function to apply min-height to editor
        const applyMinHeight = () => {
          if (enableMinHeightCheckbox.checked) {
            const selectedUnit = Array.from(heightUnitRadios).find(
              (r) => r.checked
            ).value;
            const heightVal = minHeightValue.value;

            // Remove both attributes first
            aceEditor.removeAttribute("min-height-px");
            aceEditor.removeAttribute("min-height-lines");

            // Apply the selected one
            if (selectedUnit === "lines") {
              aceEditor.setAttribute("min-height-lines", heightVal);
            } else {
              aceEditor.setAttribute("min-height-px", heightVal);
            }
          } else {
            // Remove both attributes when disabled
            aceEditor.removeAttribute("min-height-px");
            aceEditor.removeAttribute("min-height-lines");
          }
          updateHtmlView();
        };

        // Min-height enable/disable toggle
        enableMinHeightCheckbox.addEventListener("change", () => {
          if (enableMinHeightCheckbox.checked) {
            minHeightControls.style.display = "block";
          } else {
            minHeightControls.style.display = "none";
          }
          applyMinHeight();
        });

        // Min-height unit radio change
        heightUnitRadios.forEach((radio) => {
          radio.addEventListener("change", applyMinHeight);
        });

        // Min-height value input change
        minHeightValue.addEventListener("input", applyMinHeight);

        // Handle up/down buttons for all selects
        wrapper.addEventListener("click", (e) => {
          if (e.target.classList.contains("select-btn")) {
            const selectId = e.target.getAttribute("data-select");
            const direction = e.target.getAttribute("data-dir");
            const selectElement = document.getElementById(selectId);

            if (selectElement) {
              const currentIndex = selectElement.selectedIndex;
              let newIndex = currentIndex;

              if (direction === "up" && currentIndex > 0) {
                newIndex = currentIndex - 1;
              } else if (
                direction === "down" &&
                currentIndex < selectElement.options.length - 1
              ) {
                newIndex = currentIndex + 1;
              }

              if (newIndex !== currentIndex) {
                selectElement.selectedIndex = newIndex;
                // Trigger change event
                const changeEvent = new Event("change", { bubbles: true });
                selectElement.dispatchEvent(changeEvent);
              }
            }
          }
        });

        console.log(`‚úÖ Added editor #${editorCounter}`);
      }

      function removeEditor(wrapperId) {
        const wrapper = document.getElementById(wrapperId);
        if (wrapper) {
          wrapper.remove();
          console.log(`üóëÔ∏è Removed ${wrapperId}`);

          // Show empty state if no editors left
          const editorsList = document.getElementById("editors-list");
          if (editorsList.children.length === 0) {
            const emptyState = document.createElement("div");
            emptyState.className = "empty-state";
            emptyState.textContent = 'Click "Add New Editor" to get started!';
            editorsList.appendChild(emptyState);
          }
        }
      }

      // Add one editor by default
      window.addEventListener("load", () => {
        console.log("‚úÖ Dynamic demo loaded!");
        console.log("üí° Try changing the controls to see live updates!");
        addEditor();
      });
    </script>

    <hr />

    <h2>data-eval || data-eval="module"</h2>
    <ace-editor id="editor-eval" lang="js" data-eval="module">
      <script type="ace">
        alert("Hello, World!");
        if (true) {
            console.log("This is a test.");
        }
        // JavaScript Example
        function fibonacci(n) {
            if (n <= 1) return n;
            return fibonacci(n - 1) + fibonacci(n - 2);
        }
      </script>
    </ace-editor>

    <h2>onChange - Ace Editor Web Component</h2>
    <p>
      <strong>‚úÖ Behavior:</strong> Just like native textarea, programmatic
      value changes (via <code>.value = "..."</code> or
      <code>.setValue(...)</code>) do NOT fire 'input' event. Only user
      typing/editing triggers the 'input' event.
    </p>

    <style>
      .onchange-demo {
        display: flex;
        gap: 20px;
        margin: 20px 0;
      }
      .onchange-demo > div {
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      .onchange-demo h3 {
        margin: 0 0 10px 0;
        color: #333;
      }
      #onchange-output {
        flex: 1;
        min-height: 300px;
      }
    </style>

    <div class="onchange-demo">
      <div>
        <h3>üìù Editable Code</h3>
        <ace-editor id="editor-onchange" lang="javascript" data-eval>
          <script type="ace">
            var acecomp = document.querySelector('#editor-onchange');
            var output = document.querySelector('#onchange-output');
            var replace_content = document.querySelector('#replace_content');

            // Bind to the 'input' event
            acecomp.addEventListener('input', (e) => {
              // Extract content from editor
              output.value = e.target.getValue();
              console.log('üìù Content updated:', e.target.getValue().substring(0, 50) + '...');
            });

            // Set initial content
            output.value = acecomp.getValue();

            replace_content.addEventListener('click', () => {
              // Replace editor content programmatically
              // Notice: 'input' event will NOT fire (matches native textarea behavior)

              // You can use either syntax:
              // acecomp.setValue('new code');  // Method call
              // acecomp.value = 'new code';    // Property assignment (same as textarea.value = ...)

              acecomp.value = '// Content replaced programmatically!\nconsole.log("New content set.");\n\n// ‚ùå Notice: The right side did NOT update!\n// That\'s because acecomp.value = "..." does NOT trigger input event.\n// This matches native textarea behavior.';

              console.log('üî¥ Setting acecomp.value programmatically - NO input event fired!');
            });
          </script>
        </ace-editor>
        <button id="replace_content">replace content</button>
      </div>
      <div>
        <h3>üì§ Extracted Content (via 'input' event)</h3>
        <textarea id="onchange-output" readonly></textarea>
      </div>
    </div>

    <h2>Native Textarea Comparison</h2>
    <p>
      <strong>‚ö†Ô∏è Important:</strong> Native HTML elements (input, textarea) do
      NOT fire 'input' event when their value is set programmatically. Only user
      interaction triggers it.
    </p>

    <div class="onchange-demo">
      <div>
        <h3>üìù Editable Textarea</h3>
        <textarea
          id="native-textarea"
          style="
            width: 100%;
            min-height: 200px;
            font-family: monospace;
            padding: 10px;
          "
        >
// Edit this text and watch it appear on the right!
function greet(name) {
  console.log("Hello, " + name + "!");
}

greet("World");</textarea
        >
        <button id="replace_textarea_content">
          Replace Content (no 'input' event!)
        </button>
      </div>
      <div>
        <h3>üì§ Extracted Content (via 'input' event)</h3>
        <textarea id="native-output" readonly></textarea>
      </div>
    </div>

    <script>
      // Native textarea demo
      const nativeTextarea = document.querySelector("#native-textarea");
      const nativeOutput = document.querySelector("#native-output");
      const replaceTextareaBtn = document.querySelector(
        "#replace_textarea_content"
      );

      // Bind to the 'input' event
      nativeTextarea.addEventListener("input", (e) => {
        // Extract content from textarea
        nativeOutput.value = e.target.value;
        console.log(
          "üìù Native textarea input event fired:",
          e.target.value.substring(0, 50) + "..."
        );
      });

      // Set initial content
      nativeOutput.value = nativeTextarea.value;

      // Button click - this will NOT trigger 'input' event
      replaceTextareaBtn.addEventListener("click", () => {
        console.log(
          "üî¥ Setting textarea.value programmatically - NO input event will fire!"
        );
        nativeTextarea.value =
          '// Content replaced programmatically!\nconsole.log("New content set.");\n\n// ‚ùå Notice: The right side did NOT update!\n// That\'s because textarea.value = "..." does NOT trigger input event.';
      });
    </script>

    <hr />

    <h2>Advanced: Access Native Ace Editor with getEditor()</h2>
    <p>
      <strong>üîß Direct Access:</strong> Use <code>.getEditor()</code> to access
      the native Ace Editor instance and use advanced features not exposed by
      our web component API.
    </p>

    <div
      style="
        background: white;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      "
    >
      <h3 style="margin-top: 0">üîç Advanced Features Demo</h3>

      <div
        style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 20px;
          margin-bottom: 20px;
        "
      >
        <div>
          <h4 style="margin: 0 0 10px 0">Search & Replace</h4>
          <div style="display: flex; flex-direction: column; gap: 8px">
            <input
              type="text"
              id="search-term"
              placeholder="Search for..."
              value="let"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px"
            />
            <input
              type="text"
              id="replace-term"
              placeholder="Replace with..."
              value="const"
              style="padding: 8px; border: 1px solid #ddd; border-radius: 4px"
            />
            <div style="display: flex; gap: 8px">
              <button
                onclick="findNext()"
                style="
                  flex: 1;
                  padding: 8px;
                  background: #667eea;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                "
              >
                Find Next
              </button>
              <button
                onclick="replaceNext()"
                style="
                  flex: 1;
                  padding: 8px;
                  background: #28a745;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                "
              >
                Replace
              </button>
              <button
                onclick="replaceAll()"
                style="
                  flex: 1;
                  padding: 8px;
                  background: #dc3545;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                "
              >
                Replace All
              </button>
            </div>
          </div>
        </div>

        <div>
          <h4 style="margin: 0 0 10px 0">Editor Controls</h4>
          <div style="display: flex; flex-direction: column; gap: 8px">
            <button
              onclick="toggleLineNumbers()"
              style="
                padding: 8px;
                background: #667eea;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
              "
            >
              Toggle Line Numbers
            </button>
            <button
              onclick="setFontSize()"
              style="
                padding: 8px;
                background: #667eea;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
              "
            >
              Increase Font Size
            </button>
            <button
              onclick="gotoLine()"
              style="
                padding: 8px;
                background: #667eea;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
              "
            >
              Go to Line 11 (findNext)
            </button>
            <button
              onclick="addMarker()"
              style="
                padding: 8px;
                background: #ff6b6b;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
              "
            >
              Highlight Lines 5-8 (getEditor)
            </button>
          </div>
        </div>
      </div>

      <ace-editor id="advanced-editor" lang="javascript" data-eval>
        <script type="ace">
          // This editor demonstrates getEditor() by setting up controls that operate on ITSELF!
          // The code below executes once via data-eval and sets up the interactive demo.

          const advancedEditor = document.querySelector('#advanced-editor');
          let currentFontSize = 14;
          let lineNumbersVisible = true;
          let highlightMarker = null;

          // Get the native Ace Editor instance - this is the key feature being demonstrated!
          const editor = advancedEditor.getEditor();

          // Find next occurrence in THIS editor
          window.findNext = () => {
            const searchTerm = document.getElementById('search-term').value;
            const resultsDiv = document.getElementById('search-results');

            if (!searchTerm) {
              resultsDiv.textContent = '‚ö†Ô∏è Please enter a search term';
              return;
            }

            editor.find(searchTerm, {
              backwards: false,
              wrap: true,
              caseSensitive: false,
              wholeWord: false,
              regExp: false
            });

            const selection = editor.getSelection();
            const range = selection.getRange();

            if (!range.isEmpty()) {
              resultsDiv.textContent = `‚úÖ Found at line ${range.start.row + 1}, column ${range.start.column + 1}`;
            } else {
              resultsDiv.textContent = '‚ùå No matches found';
            }
          };

          // Replace next occurrence in THIS editor
          window.replaceNext = () => {
            const searchTerm = document.getElementById('search-term').value;
            const replaceTerm = document.getElementById('replace-term').value;
            const resultsDiv = document.getElementById('search-results');

            if (!searchTerm) {
              resultsDiv.textContent = '‚ö†Ô∏è Please enter a search term';
              return;
            }

            editor.find(searchTerm, {
              backwards: false,
              wrap: true,
              caseSensitive: false,
              wholeWord: false,
              regExp: false
            });

            const selection = editor.getSelection();
            const range = selection.getRange();

            if (!range.isEmpty()) {
              editor.replace(replaceTerm);
              resultsDiv.textContent = `‚úÖ Replaced at line ${range.start.row + 1}`;
            } else {
              resultsDiv.textContent = '‚ùå No matches found to replace';
            }
          };

          // Replace all occurrences in THIS editor
          window.replaceAll = () => {
            const searchTerm = document.getElementById('search-term').value;
            const replaceTerm = document.getElementById('replace-term').value;
            const resultsDiv = document.getElementById('search-results');

            if (!searchTerm) {
              resultsDiv.textContent = '‚ö†Ô∏è Please enter a search term';
              return;
            }

            const count = editor.replaceAll(replaceTerm, {
              needle: searchTerm,
              caseSensitive: false,
              wholeWord: false,
              regExp: false
            });

            resultsDiv.textContent = `‚úÖ Replaced ${count} occurrence(s)`;
          };

          // Toggle line numbers for THIS editor
          window.toggleLineNumbers = () => {
            lineNumbersVisible = !lineNumbersVisible;
            editor.renderer.setShowGutter(lineNumbersVisible);
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.textContent = `‚úÖ Line numbers ${lineNumbersVisible ? 'enabled' : 'disabled'}`;
          };

          // Increase font size of THIS editor
          window.setFontSize = () => {
            currentFontSize += 2;
            if (currentFontSize > 24) currentFontSize = 12; // Reset after max
            editor.setFontSize(currentFontSize);
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.textContent = `‚úÖ Font size set to ${currentFontSize}px`;
          };

          // Go to line 30 in THIS editor (where the find/replace functions start)
          window.gotoLine = () => {
            editor.gotoLine(11, 0, true);
            editor.focus();
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.textContent = `‚úÖ Jumped to line 30 (find function)`;
          };

          // Add marker to highlight lines 12-15 (the getEditor() call!)
          window.addMarker = () => {
            const Range = editor.getSelectionRange().constructor;
            const resultsDiv = document.getElementById('search-results');

            // Remove previous marker if exists
            if (highlightMarker !== null) {
              editor.session.removeMarker(highlightMarker);
              highlightMarker = null;
              resultsDiv.textContent = `‚úÖ Highlight removed`;
              return;
            }

            // Highlight the getEditor() call (lines 12-14)
            const range = new Range(4, 0, 7, 0); // 0-indexed
            highlightMarker = editor.session.addMarker(range, "ace_selection", "fullLine");
            resultsDiv.textContent = `‚úÖ Lines 5-7 highlighted (the getEditor() magic!)`;
          };

          console.log('‚úÖ Advanced editor features initialized using getEditor()!');
          console.log('üí° Try: Search "let" and replace with "const", then click Replace All!');
        </script>
      </ace-editor>

      <div
        id="search-results"
        style="
          margin-top: 15px;
          padding: 10px;
          background: #f8f9fa;
          border-radius: 4px;
          font-family: monospace;
          font-size: 14px;
          min-height: 30px;
        "
      >
        Ready to search...
      </div>
    </div>
  </body>
</html>
